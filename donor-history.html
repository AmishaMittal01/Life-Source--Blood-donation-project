<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LifeSource â€” Donation History</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body { background-color: #fef5f5; }
  </style>
</head>

<body class="font-sans">

  <!-- HEADER -->
  <header class="bg-red-600 text-white py-3 shadow-md">
    <h1 class="text-center text-lg font-semibold">Donation History</h1>
  </header>

  <!-- BACK -->
  <div class="p-4">
    <button onclick="history.back()" class="text-red-600 font-semibold hover:underline">&larr; Back</button>
  </div>

  <!-- HISTORY TABLE -->
  <div class="max-w-5xl mx-auto bg-white p-10 rounded-xl shadow-xl">

    <h2 class="text-3xl font-bold text-red-600 mb-6">Your Donation Records</h2>

    <table class="w-full text-left border-collapse">
      <thead>
        <tr class="border-b">
          <th class="py-3">Date</th>
          <th class="py-3">Camp</th>
          <th class="py-3">Blood Group</th>
          <th class="py-3">Units</th>
          <th class="py-3">Status</th>
        </tr>
      </thead>

      <tbody id="historyBody"></tbody>
    </table>

  </div>

  <script>
    const donor = JSON.parse(localStorage.getItem("donor"));
    if (!donor) location.href = "donor-login.html";

    async function loadHistory() {
      const res = await fetch(`http://localhost:5001/api/donors/${donor.donor_id}/donations`);
      const history = await res.json();

      const body = document.getElementById("historyBody");

      if (history.length === 0) {
        body.innerHTML = `<tr><td colspan="5" class="text-center py-4 text-slate-600">
          No donation records found.
        </td></tr>`;
        return;
      }

      body.innerHTML = history.map(item => `
        <tr class="border-b">
          <td class="py-3">${item.donation_date}</td>
          <td class="py-3">${item.camp_name}</td>
          <td class="py-3">${item.blood_group}</td>
          <td class="py-3">${item.units_collected}</td>
          <td class="py-3 font-semibold ${item.status === "Successful" ? "text-green-600" : "text-red-600"}">${item.status}</td>
        </tr>
      `).join("");
    }

    loadHistory();
  </script>

</body>

</html>
